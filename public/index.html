<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Floorplan Photo Editor Worker</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: #0b1420;
        color: #f8fafc;
      }

      body {
        margin: 0;
        padding: 0 1.5rem 3rem;
        max-width: 64rem;
        margin-inline: auto;
        line-height: 1.6;
      }

      header {
        padding-block: 3rem 1.5rem;
        text-align: center;
      }

      h1 {
        font-size: clamp(2.5rem, 5vw, 3.25rem);
        margin-bottom: 0.25rem;
      }

      p.lead {
        font-size: 1.125rem;
        color: #cbd5f5;
        margin: 0;
      }

      main {
        display: grid;
        gap: 2rem;
      }

      section {
        background: rgba(15, 23, 42, 0.65);
        border: 1px solid rgba(148, 163, 184, 0.25);
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 24px 48px rgba(15, 23, 42, 0.35);
      }

      h2 {
        font-size: 1.5rem;
        margin-top: 0;
      }

      ul {
        padding-left: 1.25rem;
      }

      code {
        font-family: "JetBrains Mono", "SFMono-Regular", Menlo, monospace;
        background: rgba(148, 163, 184, 0.15);
        padding: 0.15rem 0.4rem;
        border-radius: 0.35rem;
      }

      a {
        color: #7dd3fc;
      }

      footer {
        text-align: center;
        font-size: 0.875rem;
        color: #94a3b8;
        margin-top: 2rem;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Floorplan Photo Editor Worker</h1>
      <p class="lead">Orchestrate floor plan tweaks and angle-aware photo edits with Cloudflare Images + Gemini.</p>
    </header>
    <main>
      <section>
        <h2>Key Capabilities</h2>
        <ul>
          <li>Upload baseline floor plans or photos and seed version history automatically.</li>
          <li>Apply structured floor-plan operations or localized photo edits via the <code>/edit</code> endpoint.</li>
          <li>Generate angle-consistent renders and persist every variant to Cloudflare Images with rich metadata.</li>
        </ul>
      </section>
      <section>
        <h2>API Usage</h2>
        <p>Send a <code>POST</code> request to <code>/edit</code> with the payload:</p>
        <pre><code>{
  "client_request_id": "uuid",
  "base_prompt": "Design intent...",
  "baseline_image_id": "img_original",
  "current_image_id": "img_current",
  "floor_plan_asset": { "type": "svg", "value": "&lt;svg&gt;..." },
  "angles": [{
    "id": "north_wall",
    "camera": { "az": 45, "elev": 15, "fov": 60, "pos": [4, 2.5, -3] }
  }],
  "edit_request": {
    "floor_plan_ops": [{ "op": "extend_wall", "line": [0,0,10,0] }],
    "photo_ops": [{ "op": "render_angle", "angle_id": "north_wall" }]
  }
}</code></pre>
      </section>
      <section>
        <h2>Local Development</h2>
        <ol>
          <li><code>npm install</code></li>
          <li><code>npm run dev</code> to start the Worker locally.</li>
          <li><code>npm run deploy</code> to publish updates.</li>
        </ol>
      </section>
    </main>
    <footer>
      <p>Powered by Cloudflare Workers, Images, and Google Gemini.</p>
    </footer>
  </body>
</html>
